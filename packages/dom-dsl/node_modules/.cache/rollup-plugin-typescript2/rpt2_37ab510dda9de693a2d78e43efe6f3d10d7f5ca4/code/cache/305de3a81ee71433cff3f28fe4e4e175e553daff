{"code":"import { createFragment } from \"dom\";\r\nimport { runEffect } from \"atom\";\r\nimport { notNullOrUndefined } from \"shared\";\r\n// utility lenses for unboxing index and item from an IndexedItem\r\nexport const getKey = (item) => item[0];\r\nexport const getItem = (item) => item[1];\r\nexport const forEach = (props) => {\r\n    let { items, render } = props;\r\n    const anchor = createFragment([]);\r\n    let currentItemIndex = new Map();\r\n    const ref = runEffect(() => {\r\n        const newItems = items();\r\n        const newItemOrder = newItems.map(getKey);\r\n        const newItemNodesIndex = new Map(newItems.map((item) => [\r\n            getKey(item),\r\n            currentItemIndex.get(getKey(item)) ?? render(getItem(item)),\r\n        ]));\r\n        const newChildren = newItemOrder\r\n            .map((key) => newItemNodesIndex.get(key))\r\n            .filter(notNullOrUndefined);\r\n        anchor.setChildren(newChildren);\r\n        currentItemIndex = newItemNodesIndex;\r\n    });\r\n    anchor.registerOnMountHook(() => ref.activate());\r\n    anchor.registerOnUnmountHook(() => ref.deactivate());\r\n    return anchor;\r\n};\r\n//# sourceMappingURL=forEach.js.map","references":["/Users/eric.rodriguez/personal/dev/recoil/packages/dom/lib/index.ts","/Users/eric.rodriguez/personal/dev/recoil/packages/shared/lib/index.ts","/Users/eric.rodriguez/personal/dev/recoil/packages/dom/lib/index.ts","/Users/eric.rodriguez/personal/dev/recoil/packages/atom/lib/index.ts","/Users/eric.rodriguez/personal/dev/recoil/packages/shared/lib/index.ts"],"map":"{\"version\":3,\"file\":\"forEach.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../../lib/control/forEach.ts\"],\"names\":[],\"mappings\":\"AAEA,OAAO,EAAE,cAAc,EAAE,MAAM,KAAK,CAAC;AACrC,OAAO,EAAE,SAAS,EAAE,MAAM,MAAM,CAAC;AACjC,OAAO,EAAE,kBAAkB,EAAE,MAAM,QAAQ,CAAC;AAK5C,iEAAiE;AACjE,MAAM,CAAC,MAAM,MAAM,GAAG,CAAI,IAAoB,EAAU,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;AACnE,MAAM,CAAC,MAAM,OAAO,GAAG,CAAI,IAAoB,EAAK,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;AAO/D,MAAM,CAAC,MAAM,OAAO,GAAG,CACrB,KAAsB,EACT,EAAE;IACf,IAAI,EAAE,KAAK,EAAE,MAAM,EAAE,GAAG,KAAK,CAAC;IAE9B,MAAM,MAAM,GAAG,cAAc,CAAC,EAAE,CAAC,CAAC;IAElC,IAAI,gBAAgB,GAA6B,IAAI,GAAG,EAAE,CAAC;IAE3D,MAAM,GAAG,GAAG,SAAS,CAAC,GAAS,EAAE;QAC/B,MAAM,QAAQ,GAAqB,KAAK,EAAE,CAAC;QAC3C,MAAM,YAAY,GAAa,QAAQ,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;QACpD,MAAM,iBAAiB,GAA6B,IAAI,GAAG,CACzD,QAAQ,CAAC,GAAG,CAAC,CAAC,IAAoB,EAAyB,EAAE,CAAC;YAC5D,MAAM,CAAC,IAAI,CAAC;YACZ,gBAAgB,CAAC,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,IAAI,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;SAC5D,CAAC,CACH,CAAC;QAEF,MAAM,WAAW,GAAkB,YAAY;aAC5C,GAAG,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,iBAAiB,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;aACxC,MAAM,CAAC,kBAAkB,CAAkB,CAAC;QAE/C,MAAM,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC;QAEhC,gBAAgB,GAAG,iBAAiB,CAAC;IACvC,CAAC,CAAC,CAAC;IACH,MAAM,CAAC,mBAAmB,CAAC,GAAG,EAAE,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAC,CAAC;IACjD,MAAM,CAAC,qBAAqB,CAAC,GAAG,EAAE,CAAC,GAAG,CAAC,UAAU,EAAE,CAAC,CAAC;IAErD,OAAO,MAAM,CAAC;AAChB,CAAC,CAAC\"}","dtsmap":{"name":"/Users/eric.rodriguez/personal/dev/recoil/packages/dom-dsl/node_modules/.cache/rollup-plugin-typescript2/placeholder/dom-dsl/lib/control/forEach.d.ts.map","writeByteOrderMark":false,"text":"{\"version\":3,\"file\":\"forEach.d.ts\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../../lib/control/forEach.ts\"],\"names\":[],\"mappings\":\"AAAA,OAAO,EAAE,KAAK,EAAE,MAAM,KAAK,CAAC;AAC5B,OAAO,EAAE,QAAQ,EAAE,QAAQ,EAAE,MAAM,QAAQ,CAAC;AAM5C,oBAAY,WAAW,CAAC,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;AAGzC,eAAO,MAAM,MAAM,+BAA8B,MAAiB,CAAC;AACnE,eAAO,MAAM,OAAO,gCAA0C,CAAC;AAE/D,oBAAY,YAAY,CAAC,CAAC,IAAI;IAC5B,KAAK,EAAE,QAAQ,CAAC,WAAW,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;IAClC,MAAM,EAAE,QAAQ,CAAC,CAAC,EAAE,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC;CAClC,CAAC;AAEF,eAAO,MAAM,OAAO,gDAEjB,MAAM,IAAI,CA6BZ,CAAC\"}"},"dts":{"name":"/Users/eric.rodriguez/personal/dev/recoil/packages/dom-dsl/node_modules/.cache/rollup-plugin-typescript2/placeholder/dom-dsl/lib/control/forEach.d.ts","writeByteOrderMark":false,"text":"import { WNode } from \"dom\";\r\nimport { Function, Supplier } from \"shared\";\r\nexport declare type IndexedItem<T> = [string, T];\r\nexport declare const getKey: <T>(item: IndexedItem<T>) => string;\r\nexport declare const getItem: <T>(item: IndexedItem<T>) => T;\r\nexport declare type ForEachProps<T> = {\r\n    items: Supplier<IndexedItem<T>[]>;\r\n    render: Function<T, WNode<Node>>;\r\n};\r\nexport declare const forEach: <T extends Object>(props: ForEachProps<T>) => WNode<Node>;\r\n//# sourceMappingURL=forEach.d.ts.map"}}
