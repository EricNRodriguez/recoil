{"code":"import { isAtom, runEffect } from \"atom\";\r\nimport { WNode, createFragment } from \"dom\";\r\nimport { WDerivationCache } from \"shared\";\r\nconst nullOrUndefinedNode = new WNode(document.createComment(\"null\"));\r\nexport const ifElse = (props) => {\r\n    let { condition, ifTrue, ifFalse } = props;\r\n    ifFalse ??= () => nullOrUndefinedNode;\r\n    if (typeof condition === \"boolean\") {\r\n        return staticIfElse(condition, ifTrue, ifFalse);\r\n    }\r\n    const cache = new WDerivationCache((value) => (value ? ifTrue() : ifFalse()));\r\n    const anchor = createFragment([]);\r\n    let currentRenderedState;\r\n    let currentRenderedSubtree = nullOrUndefinedNode;\r\n    const ref = runEffect(() => {\r\n        const state = isAtom(condition)\r\n            ? condition.get()\r\n            : condition();\r\n        if (state === currentRenderedState) {\r\n            return;\r\n        }\r\n        currentRenderedState = state;\r\n        currentRenderedSubtree = cache.get(state);\r\n        anchor.setChildren([\r\n            currentRenderedSubtree === nullOrUndefinedNode\r\n                ? null\r\n                : currentRenderedSubtree,\r\n        ]);\r\n    });\r\n    anchor.registerOnUnmountHook(() => ref.deactivate());\r\n    anchor.registerOnMountHook(() => ref.activate());\r\n    return anchor;\r\n};\r\nconst staticIfElse = (condition, ifTrue, ifFalse) => {\r\n    const anchor = createFragment([]);\r\n    anchor.setChildren([condition ? ifTrue() : ifFalse()].filter((c) => c !== nullOrUndefinedNode));\r\n    return anchor;\r\n};\r\n//# sourceMappingURL=if.js.map","references":["/Users/eric.rodriguez/personal/dev/recoil/packages/dom-dsl/node_modules/atom/lib/index.ts","/Users/eric.rodriguez/personal/dev/recoil/packages/dom-dsl/node_modules/dom/lib/index.ts","/Users/eric.rodriguez/personal/dev/recoil/packages/dom-dsl/node_modules/shared/lib/index.ts"],"map":"{\"version\":3,\"file\":\"if.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../lib/control/if.ts\"],\"names\":[],\"mappings\":\"AAAA,OAAO,EAAS,MAAM,EAAE,SAAS,EAAE,MAAM,MAAM,CAAC;AAChD,OAAO,EAAE,KAAK,EAAE,cAAc,EAAE,MAAM,KAAK,CAAC;AAC5C,OAAO,EAAY,gBAAgB,EAAE,MAAM,QAAQ,CAAA;AAYnD,MAAM,mBAAmB,GAAG,IAAI,KAAK,CAAC,QAAQ,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC,CAAC;AACtE,MAAM,CAAC,MAAM,MAAM,GAAG,CAAC,KAAkB,EAAe,EAAE;IACxD,IAAI,EAAE,SAAS,EAAE,MAAM,EAAE,OAAO,EAAE,GAAG,KAAK,CAAC;IAE3C,OAAO,KAAK,GAAG,EAAE,CAAC,mBAAmB,CAAC;IAEtC,IAAI,OAAO,SAAS,KAAK,SAAS,EAAE;QAClC,OAAO,YAAY,CAAC,SAAS,EAAE,MAAM,EAAE,OAAO,CAAC,CAAC;KACjD;IAED,MAAM,KAAK,GAA2C,IAAI,gBAAgB,CAGxE,CAAC,KAAc,EAAE,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC,OAAQ,EAAE,CAAC,CAAC,CAAC;IAEvD,MAAM,MAAM,GAAG,cAAc,CAAC,EAAE,CAAC,CAAC;IAElC,IAAI,oBAA6B,CAAC;IAClC,IAAI,sBAAsB,GAAgB,mBAAmB,CAAC;IAC9D,MAAM,GAAG,GAAG,SAAS,CAAC,GAAS,EAAE;QAC/B,MAAM,KAAK,GAAY,MAAM,CAAC,SAAS,CAAC;YACtC,CAAC,CAAE,SAA4B,CAAC,GAAG,EAAE;YACrC,CAAC,CAAE,SAA+B,EAAE,CAAC;QAEvC,IAAI,KAAK,KAAK,oBAAoB,EAAE;YAClC,OAAO;SACR;QAED,oBAAoB,GAAG,KAAK,CAAC;QAC7B,sBAAsB,GAAG,KAAK,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;QAE1C,MAAM,CAAC,WAAW,CAAC;YACjB,sBAAsB,KAAK,mBAAmB;gBAC5C,CAAC,CAAC,IAAI;gBACN,CAAC,CAAC,sBAAsB;SAC3B,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IACH,MAAM,CAAC,qBAAqB,CAAC,GAAG,EAAE,CAAC,GAAG,CAAC,UAAU,EAAE,CAAC,CAAC;IACrD,MAAM,CAAC,mBAAmB,CAAC,GAAG,EAAE,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAC,CAAC;IAEjD,OAAO,MAAM,CAAC;AAChB,CAAC,CAAC;AACF,MAAM,YAAY,GAAG,CACnB,SAAkB,EAClB,MAA6B,EAC7B,OAA8B,EACjB,EAAE;IACf,MAAM,MAAM,GAAG,cAAc,CAAC,EAAE,CAAC,CAAC;IAElC,MAAM,CAAC,WAAW,CAChB,CAAC,SAAS,CAAC,CAAC,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC,OAAO,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,KAAK,mBAAmB,CAAC,CAC5E,CAAC;IAEF,OAAO,MAAM,CAAC;AAChB,CAAC,CAAC\"}","dtsmap":{"name":"/Users/eric.rodriguez/personal/dev/recoil/packages/dom-dsl/node_modules/.cache/rollup-plugin-typescript2/placeholder/lib/control/if.d.ts.map","writeByteOrderMark":false,"text":"{\"version\":3,\"file\":\"if.d.ts\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../lib/control/if.ts\"],\"names\":[],\"mappings\":\"AAAA,OAAO,EAAE,KAAK,EAAqB,MAAM,MAAM,CAAC;AAChD,OAAO,EAAE,KAAK,EAAkB,MAAM,KAAK,CAAC;AAC5C,OAAO,EAAE,QAAQ,EAAoB,MAAM,QAAQ,CAAA;AAEnD,oBAAY,eAAe,GAAG,KAAK,CAAC,OAAO,CAAC,GAAG,QAAQ,CAAC,OAAO,CAAC,GAAG,OAAO,CAAC;AAE3E,oBAAY,aAAa,GAAG,QAAQ,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC;AAElD,oBAAY,WAAW,GAAG;IACxB,SAAS,EAAE,eAAe,CAAC;IAC3B,MAAM,EAAE,aAAa,CAAC;IACtB,OAAO,CAAC,EAAE,aAAa,CAAC;CACzB,CAAC;AAGF,eAAO,MAAM,MAAM,UAAW,WAAW,KAAG,MAAM,IAAI,CAwCrD,CAAC\"}"},"dts":{"name":"/Users/eric.rodriguez/personal/dev/recoil/packages/dom-dsl/node_modules/.cache/rollup-plugin-typescript2/placeholder/lib/control/if.d.ts","writeByteOrderMark":false,"text":"import { IAtom } from \"atom\";\r\nimport { WNode } from \"dom\";\r\nimport { Supplier } from \"shared\";\r\nexport declare type IfElseCondition = IAtom<boolean> | Supplier<boolean> | boolean;\r\nexport declare type IfElseContent = Supplier<WNode<Node>>;\r\nexport declare type IfElseProps = {\r\n    condition: IfElseCondition;\r\n    ifTrue: IfElseContent;\r\n    ifFalse?: IfElseContent;\r\n};\r\nexport declare const ifElse: (props: IfElseProps) => WNode<Node>;\r\n//# sourceMappingURL=if.d.ts.map"}}
